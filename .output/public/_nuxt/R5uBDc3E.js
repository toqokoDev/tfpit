import{P as pe,_ as We}from"./Cm8hpxjP.js";import{a as _e,u as Xe}from"./CnvqL-Ka.js";import{b as Ye,c as Ze,j as et}from"./qjfj-mJN.js";import{i as tt,_ as at,a as lt,b as ot,c as st,d as nt,e as rt}from"./CR-AhlAP.js";import{s as te,e as N,z as Ve,f,o as s,w as l,r as ae,m as le,g as e,C as it,A as de,q as x,D as ut,E as dt,M as ct,Q as pt,c as g,n as fe,h as ce,O as _t,b as a,H as ft,I as mt,a as r,t as q,d as m,k as $,u as gt,F as Z,j as ee,T as vt,B as V}from"./DZ62IjT-.js";import{u as ht,_ as bt}from"./Cu0S5-rx.js";import{c as yt,l as Ce,t as Ue,_ as kt,F as J,a as wt,e as xt,f as Ct,b as Ut}from"./C5YCDKKw.js";import{_ as $t}from"./DJuPW7wP.js";import{V as St,a as $e}from"./CvirFqA_.js";import{r as It}from"./CMpkczBb.js";import{_ as Pt}from"./CnmO8G8o.js";import{_ as Vt,a as qt}from"./mPSjGQRP.js";import{_ as Dt}from"./CF40h-xm.js";import{E as qe,H as jt,G as Bt}from"./BUPqiz4f.js";import{u as Mt}from"./DWzOavYo.js";import{u as Tt}from"./oQ2KJ8HL.js";import{a as Ft,C as Rt}from"./6oSe0hi4.js";const zt=te("lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);const Et=te("pencil",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]);const Se=te("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);const Ie=te("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]]);const Pe=te("upload",[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]]);var Lt=N({__name:"DialogTrigger",props:{asChild:{type:Boolean,required:!1},as:{type:null,required:!1,default:"button"}},setup(D){const h=D,i=tt(),{forwardRef:C,currentElement:b}=_e();return i.contentId||=Ye(void 0,"reka-dialog-content"),Ve(()=>{i.triggerElement.value=b.value}),(y,S)=>(s(),f(e(pe),le(h,{ref:e(C),type:y.as==="button"?"button":void 0,"aria-haspopup":"dialog","aria-expanded":e(i).open.value||!1,"aria-controls":e(i).open.value?e(i).contentId:void 0,"data-state":e(i).open.value?"open":"closed",onClick:e(i).onOpenToggle}),{default:l(()=>[ae(y.$slots,"default")]),_:3},16,["type","aria-expanded","aria-controls","data-state","onClick"]))}}),Ot=Lt;const[Gt,At]=Ze("SwitchRoot");var Nt=N({__name:"SwitchRoot",props:{defaultValue:{type:Boolean,required:!1},modelValue:{type:[Boolean,null],required:!1,default:void 0},disabled:{type:Boolean,required:!1},id:{type:String,required:!1},value:{type:String,required:!1,default:"on"},asChild:{type:Boolean,required:!1},as:{type:null,required:!1,default:"button"},name:{type:String,required:!1},required:{type:Boolean,required:!1}},emits:["update:modelValue"],setup(D,{emit:h}){const i=D,C=h,{disabled:b}=it(i),y=Xe(i,"modelValue",C,{defaultValue:i.defaultValue,passive:i.modelValue===void 0});function S(){b.value||(y.value=!y.value)}const{forwardRef:R,currentElement:z}=_e(),L=ht(z),Q=de(()=>i.id&&z.value?document.querySelector(`[for="${i.id}"]`)?.innerText:void 0);return At({modelValue:y,toggleCheck:S,disabled:b}),(k,H)=>(s(),f(e(pe),le(k.$attrs,{id:k.id,ref:e(R),role:"switch",type:k.as==="button"?"button":void 0,value:k.value,"aria-label":k.$attrs["aria-label"]||Q.value,"aria-checked":e(y),"aria-required":k.required,"data-state":e(y)?"checked":"unchecked","data-disabled":e(b)?"":void 0,"as-child":k.asChild,as:k.as,disabled:e(b),onClick:S,onKeydown:ut(dt(S,["prevent"]),["enter"])}),{default:l(()=>[ae(k.$slots,"default",{modelValue:e(y)}),e(L)&&k.name?(s(),f(e(St),{key:0,type:"checkbox",name:k.name,disabled:e(b),required:k.required,value:k.value,checked:!!e(y)},null,8,["name","disabled","required","value","checked"])):x("v-if",!0)]),_:3},16,["id","type","value","aria-label","aria-checked","aria-required","data-state","data-disabled","as-child","as","disabled","onKeydown"]))}}),Ht=Nt,Kt=N({__name:"SwitchThumb",props:{asChild:{type:Boolean,required:!1},as:{type:null,required:!1,default:"span"}},setup(D){const h=Gt();return _e(),(i,C)=>(s(),f(e(pe),{"data-state":e(h).modelValue?.value?"checked":"unchecked","data-disabled":e(h).disabled.value?"":void 0,"as-child":i.asChild,as:i.as},{default:l(()=>[ae(i.$slots,"default")]),_:3},8,["data-state","data-disabled","as-child","as"]))}}),Jt=Kt;const Qt=N({__name:"DialogTrigger",props:{asChild:{type:Boolean},as:{}},setup(D){const h=D;return(i,C)=>(s(),f(e(Ot),le({"data-slot":"dialog-trigger"},h),{default:l(()=>[ae(i.$slots,"default")]),_:3},16))}}),Wt=Object.assign(Qt,{__name:"UiDialogTrigger"}),Xt=N({__name:"Textarea",props:{class:{},defaultValue:{},modelValue:{}},emits:["update:modelValue"],setup(D,{emit:h}){const i=D,b=yt(i,"modelValue",h,{passive:!0,defaultValue:i.defaultValue});return(y,S)=>ct((s(),g("textarea",{"onUpdate:modelValue":S[0]||(S[0]=R=>_t(b)?b.value=R:null),"data-slot":"textarea",class:fe(e(ce)("border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-transparent px-3 py-2 text-base shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",i.class))},null,2)),[[pt,e(b)]])}}),Yt=Object.assign(Xt,{__name:"UiTextarea"}),Zt=N({__name:"Switch",props:{defaultValue:{type:Boolean},modelValue:{type:[Boolean,null]},disabled:{type:Boolean},id:{},value:{},asChild:{type:Boolean},as:{},name:{},required:{type:Boolean},class:{}},emits:["update:modelValue"],setup(D,{emit:h}){const i=D,C=h,b=It(i,"class"),y=et(b,C);return(S,R)=>(s(),f(e(Ht),le({"data-slot":"switch"},e(y),{class:e(ce)("peer data-[state=checked]:bg-primary data-[state=unchecked]:bg-input focus-visible:border-ring focus-visible:ring-ring/50 dark:data-[state=unchecked]:bg-input/80 inline-flex h-[1.15rem] w-8 shrink-0 items-center rounded-full border border-transparent shadow-xs transition-all outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",i.class)}),{default:l(z=>[a(e(Jt),{"data-slot":"switch-thumb",class:fe(e(ce)("bg-background dark:data-[state=unchecked]:bg-foreground dark:data-[state=checked]:bg-primary-foreground pointer-events-none block size-4 rounded-full ring-0 transition-transform data-[state=checked]:translate-x-[calc(100%-2px)] data-[state=unchecked]:translate-x-0"))},{default:l(()=>[ae(S.$slots,"thumb",ft(mt(z)))]),_:2},1032,["class"])]),_:3},16,["class"]))}}),ea=Object.assign(Zt,{__name:"UiSwitch"}),ta={class:"relative aspect-[3/4] overflow-hidden bg-gradient-to-br from-muted/40 to-muted"},aa=["src","alt"],la={key:0,class:"absolute top-3 right-3 bg-background/90 backdrop-blur-sm px-2 py-1 rounded-full text-xs font-medium"},oa={class:"absolute bottom-0 left-0 right-0 bg-gradient-to-t from-black/80 to-transparent p-4 text-white"},sa={class:"flex items-center justify-between"},na={class:"flex items-center gap-4"},ra={class:"flex items-center gap-1.5"},ia={class:"text-sm font-medium"},ua=N({__name:"Portfolio",props:{category:{},description:{},image_url:{},is_public:{type:Boolean,default:!1},likes_count:{default:0},views_count:{default:0},created_at:{},updated_at:{}},setup(D){const h=D;return(i,C)=>{const b=qt,y=Vt,S=Dt;return s(),f(S,{class:"pt-0 group overflow-hidden transition-all hover:shadow-lg border hover:border-primary/15 cursor-pointer"},{default:l(()=>[r("div",ta,[r("img",{src:h.image_url[0]||"/placeholder.svg",alt:h.category,class:"h-full w-full object-cover transition-transform duration-400 group-hover:scale-[1.03]",loading:"lazy"},null,8,aa),h.image_url.length>1?(s(),g("div",la," +"+q(h.image_url.length-1),1)):x("",!0),r("div",oa,[r("div",sa,[r("div",na,[r("div",ra,[a(e(qe),{class:"w-4 h-4"}),r("span",ia,q(h.views_count),1)])])])])]),a(y,{class:"pb-3"},{default:l(()=>[a(b,{class:"mt-2 line-clamp-2 text-sm"},{default:l(()=>[m(q(h.description),1)]),_:1})]),_:1})]),_:1})}}}),da=Object.assign(ua,{__name:"BasePortfolio"}),ca={class:"container mx-auto px-4 py-8"},pa={class:"mb-6 flex items-center justify-between"},_a={class:"space-y-4"},fa={key:0,class:"grid grid-cols-4 gap-2"},ma=["src","alt"],ga=["onClick"],va={key:0,class:"grid grid-cols-1 gap-6 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4"},ha={key:1,class:"flex flex-col items-center justify-center py-16"},ba={class:"text-center"},ya={key:2,class:"grid grid-cols-1 gap-6 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4"},ka=["onClick"],wa={key:1,class:"py-4"},xa={key:0,class:"mb-6 flex justify-center"},Ca={class:"relative aspect-[3/4] w-full max-w-xs overflow-hidden rounded-lg bg-muted"},Ua=["src","alt"],$a={key:2,class:"absolute bottom-2 left-1/2 -translate-x-1/2 rounded-full bg-background/80 backdrop-blur-sm px-3 py-1 text-xs font-medium"},Sa={key:3,class:"absolute bottom-2 right-2 flex gap-1"},Ia={class:"flex flex-wrap gap-4 text-sm text-muted-foreground"},Pa={class:"flex items-center gap-2"},Va={class:"flex items-center gap-2"},qa={key:0,class:"flex items-center gap-2"},Da={key:1,class:"flex items-center gap-2"},ja={class:"mt-4 text-sm text-muted-foreground"},Ba={key:0},Ma={class:"space-y-4"},Ta={key:0,class:"grid grid-cols-4 gap-2"},Fa=["src","alt"],Ra=["onClick"],za={key:1,class:"grid grid-cols-4 gap-2"},Ea=["src","alt"],La=["onClick"],sl=N({__name:"portfolio",setup(D){const h=[{label:"Портрет",value:"Портрет"},{label:"Свадьба",value:"Свадьба"},{label:"Love Story",value:"Love Story"},{label:"Семейная фотосессия",value:"Семейная фотосессия"},{label:"Детская фотосессия",value:"Детская фотосессия"},{label:"Fashion",value:"Fashion"},{label:"Коммерческая съемка",value:"Коммерческая съемка"},{label:"Студийная съемка",value:"Студийная съемка"},{label:"Свадебная прогулка",value:"Свадебная прогулка"},{label:"Другое",value:"Другое"}],i=Mt(),C=Tt(),b=$(!1),y=$(!1),S=$(!1),R=$(!1),z=$(!1),L=$(!1),Q=$(!1),k=$(!1),H=$([]),K=$(null),oe=$(null),P=$([]),B=$([]),j=$(null),E=$([]),ue=de(()=>C.getUser().portfolio||[]),u=$(null),M=$(0),De=de(()=>j.value?{category:j.value.category||"",description:j.value.description||"",is_public:!!j.value.is_public}:{category:"",description:"",is_public:!1});async function je(){try{Q.value=!0;const{data:o}=await i.auth.getUser();if(!o?.user)return;const{data:t,error:n}=await i.from("portfolios").select(`
        id,
        image_url,
        category,
        description,
        is_public,
        likes_count,
        views_count,
        created_at,
        updated_at
      `).eq("user_id",o.user.id);if(n)throw n;const U=(t||[]).map(d=>({id:d.id,image_url:d.image_url?d.image_url.split("|").filter(_=>_.trim()):[],category:d.category,description:d.description,is_public:d.is_public,likes_count:d.likes_count,views_count:d.views_count,created_at:d.created_at,updated_at:d.updated_at}));C.updateUser({portfolio:U})}catch(o){console.error("Ошибка загрузки портфолио:",o)}finally{Q.value=!1}}function Be(o){u.value=o,M.value=0,y.value=!0}function Me(){u.value&&u.value.image_url&&(M.value=(M.value+1)%u.value.image_url.length)}function Te(){if(u.value&&u.value.image_url){const o=u.value.image_url.length;M.value=(M.value-1+o)%o}}function me(o){return new Date(o).toLocaleDateString("ru-RU",{year:"numeric",month:"long",day:"numeric"})}async function Fe(){if(!u.value)return;const o=`${window.location.origin}/portfolio/${u.value.id}`;if(!u.value.is_public){V.error("Поделиться можно только публичными портфолио");return}await Re(o)}async function Re(o){try{await navigator.clipboard.writeText(o),V.success("Ссылка скопирована в буфер обмена")}catch{const n=document.createElement("textarea");n.value=o,n.style.position="fixed",n.style.opacity="0",document.body.appendChild(n),n.select();try{document.execCommand("copy"),V.success("Ссылка скопирована в буфер обмена")}catch{V.error("Не удалось скопировать ссылку")}document.body.removeChild(n)}}Ve(async()=>{await je()});const ge=o=>{const t=o.target,n=Array.from(t.files||[]);if(n.length===0)return;const U=10*1024*1024,d=[],_=[];for(const w of n){if(!w.type.startsWith("image/")){V.error(`Файл ${w.name} не является изображением`);continue}if(w.size>U){V.error(`Файл ${w.name} слишком большой (макс. 10МБ)`);continue}d.push(w);const F=new FileReader;F.onload=T=>{const G=T.target?.result;_.push({url:G,file:w}),_.length===d.length&&(B.value=[...B.value,..._])},F.readAsDataURL(w)}P.value=[...P.value,...d]},ve=async(o,t)=>{try{k.value=!0;const n=o.name.split(".").pop(),d=`portfolios/${`${t}-${Date.now()}-${Math.random().toString(36).substring(7)}.${n}`}`,{error:_}=await i.storage.from("portfolios").upload(d,o,{upsert:!1});if(_)throw _;const{data:{publicUrl:w}}=i.storage.from("portfolios").getPublicUrl(d);return w}finally{k.value=!1}},he=async o=>{try{const n=new URL(o).pathname.split("/"),U=n.findIndex(F=>F==="portfolios");if(U===-1)return;const d=n.slice(U+1).join("/");if(!d)return;const _=d.split("?")[0],{error:w}=await i.storage.from("portfolios").remove([_]);if(w)return}catch(t){console.error("Ошибка при удалении изображения:",t)}},ze=async o=>{try{if(P.value.length===0){V.error("Выберите хотя бы одно изображение");return}R.value=!0;const t=C.getUser(),n=[];for(const G of P.value){const I=await ve(G,t.id);n.push(I)}if(n.length===0||!n[0])throw new Error("Не удалось загрузить изображения");const U=n.join("|"),{data:d,error:_}=await i.from("portfolios").insert({user_id:t.id,category:o.category,description:o.description,image_url:U,is_public:o.is_public,likes_count:0,views_count:0}).select().single();if(_)throw _;const w={id:d.id,category:d.category,description:d.description,image_url:n,is_public:d.is_public,likes_count:d.likes_count,views_count:d.views_count,created_at:d.created_at,updated_at:d.updated_at},T=[...C.getUser().portfolio||[],w];C.updateUser({portfolio:T}),V.success("Портфолио успешно добавлено"),b.value=!1,P.value=[],B.value=[],K.value&&(K.value.value="")}catch(t){V.error(t.message||"Ошибка при создании портфолио")}finally{R.value=!1}},Ee=()=>{K.value?.click()},be=o=>{P.value.splice(o,1),B.value.splice(o,1)},ye=()=>{P.value=[],B.value=[],K.value&&(K.value.value="")},Le=o=>{b.value=o,o||ye()};function Oe(o){j.value=o,E.value=[...o.image_url],B.value=[],P.value=[],H.value=[],y.value=!1,S.value=!0}const W=$(!1),O=$(null);function Ge(o){O.value=o,W.value=!0}async function Ae(){if(O.value)try{if(L.value=!0,O.value.image_url&&O.value.image_url.length>0)try{await Promise.all(O.value.image_url.map(U=>he(U)))}catch(U){console.error("Ошибка при удалении изображений:",U)}const{error:o}=await i.from("portfolios").delete().eq("id",O.value.id);if(o)throw o;const n=(C.getUser().portfolio||[]).filter(U=>U.id!==O.value.id);C.updateUser({portfolio:n}),V.success("Портфолио успешно удалено"),W.value=!1,y.value=!1,O.value=null}catch(o){console.error("Ошибка удаления портфолио:",o),V.error(o.message||"Ошибка при удалении портфолио")}finally{L.value=!1}}const Ne=o=>{S.value=o,o||(j.value=null,E.value=[],H.value=[],ye())},He=async o=>{const t=E.value[o];t&&(H.value.push(t),E.value.splice(o,1))},Ke=o=>{ge(o)},Je=async o=>{try{if(!j.value)return;if(E.value.length===0&&P.value.length===0){V.error("Выберите хотя бы одно изображение");return}z.value=!0;const t=C.getUser();let n=[...E.value];if(P.value.length>0){const I=[];for(const A of P.value){const X=await ve(A,t.id);I.push(X)}n=[...n,...I]}if(n.length===0||!n[0])throw new Error("Не удалось загрузить изображения");if(H.value.length>0)try{await Promise.all(H.value.map(I=>he(I)))}catch(I){console.error("Ошибка при удалении старых изображений:",I)}const U=n.join("|"),d={category:o.category,description:o.description,image_url:U,is_public:!!o.is_public,updated_at:new Date().toISOString()},{data:_,error:w}=await i.from("portfolios").update(d).eq("id",j.value.id).select().single();if(w)throw console.error("Supabase update error:",w),w;const F={id:_.id,category:_.category,description:_.description,image_url:n,is_public:_.is_public,likes_count:_.likes_count,views_count:_.views_count,created_at:_.created_at,updated_at:_.updated_at},G=(C.getUser().portfolio||[]).map(I=>I.id===j.value.id?F:I);C.updateUser({portfolio:G}),V.success("Портфолио успешно обновлено"),S.value=!1,j.value=null,E.value=[],P.value=[],B.value=[],oe.value&&(oe.value.value="")}catch(t){V.error(t.message||"Ошибка при обновлении портфолио")}finally{z.value=!1}};return gt({title:"Портфолио"}),(o,t)=>{const n=We,U=Wt,d=st,_=nt,w=ot,F=bt,T=xt,G=Yt,I=Ct,A=wt,X=$t,ke=ea,we=kt,xe=Ut,se=rt,ne=lt,re=at,ie=Pt,Qe=da;return s(),g("div",ca,[r("div",pa,[t[19]||(t[19]=r("div",null,[r("h1",{class:"text-3xl font-bold"},"Моё портфолио"),r("p",{class:"text-muted-foreground mt-1 text-sm"}," Управляйте своими работами ")],-1)),a(re,{open:e(b),"onUpdate:open":Le},{default:l(()=>[a(U,{"as-child":""},{default:l(()=>[a(n,null,{default:l(()=>[a(e(Se),{class:"w-4 h-4"}),t[10]||(t[10]=m(" Добавить работу ",-1))]),_:1})]),_:1}),a(ne,{class:"sm:max-w-2xl"},{default:l(()=>[a(w,null,{default:l(()=>[a(d,null,{default:l(()=>[...t[11]||(t[11]=[m("Добавить работу в портфолио",-1)])]),_:1}),a(_,null,{default:l(()=>[...t[12]||(t[12]=[m(" Заполните информацию о вашей работе ",-1)])]),_:1})]),_:1}),e(b)?(s(),f(e(Ce),{key:0,"validation-schema":e(Ue)("portfolioCreateSchema"in o?o.portfolioCreateSchema:e($e)),"initial-values":{category:"",description:"",is_public:!1},onSubmit:ze},{default:l(({resetForm:c})=>[a(we,{class:"py-4"},{default:l(()=>[a(F,{name:"category",label:"Категория",placeholder:"Выберите категорию",options:h,"errors-to-show":"all"}),a(e(J),{name:"description"},{default:l(({field:p,errors:v})=>[a(A,{"data-invalid":!!v.length},{default:l(()=>[a(T,{for:"description"},{default:l(()=>[...t[13]||(t[13]=[m(" Описание ",-1)])]),_:1}),a(G,le({id:"description",placeholder:"Опишите вашу работу","aria-invalid":!!v.length},p),null,16,["aria-invalid"]),v.length?(s(),f(I,{key:0,errors:v},null,8,["errors"])):x("",!0)]),_:2},1032,["data-invalid"])]),_:1}),a(e(J),{name:"image_file"},{default:l(({errors:p})=>[a(A,{"data-invalid":!!p.length},{default:l(()=>[a(T,null,{default:l(()=>[...t[14]||(t[14]=[m(" Изображения ",-1)])]),_:1}),r("div",_a,[e(B).length>0?(s(),g("div",fa,[(s(!0),g(Z,null,ee(e(B),(v,Y)=>(s(),g("div",{key:Y,class:"relative aspect-square w-full overflow-hidden rounded-lg bg-muted"},[r("img",{src:v.url,alt:`Превью ${Y+1}`,class:"h-full w-full object-cover"},null,8,ma),r("button",{type:"button",onClick:()=>be(Y),class:"absolute right-1 top-1 rounded-full bg-destructive p-1 text-destructive-foreground hover:bg-destructive/90"},[...t[15]||(t[15]=[r("svg",{class:"h-3 w-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[r("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])],8,ga)]))),128))])):x("",!0),r("div",null,[r("input",{ref_key:"imageInput",ref:K,type:"file",accept:"image/*",multiple:"",class:"hidden",onChange:ge},null,544),a(n,{type:"button",variant:"outline",disabled:e(k),onClick:Ee,class:"w-full"},{default:l(()=>[e(k)?(s(),f(X,{key:1,size:"sm",class:"mr-2"})):(s(),f(e(Pe),{key:0,class:"mr-2 h-4 w-4"})),m(" "+q(e(k)?"Загрузка...":e(P).length>0?`Добавить ещё (${e(P).length} выбрано)`:"Выбрать изображения"),1)]),_:1},8,["disabled"]),t[16]||(t[16]=r("p",{class:"mt-1 text-xs text-muted-foreground"}," Поддерживаемые форматы: JPG, PNG, GIF. Максимальный размер файла: 10МБ ",-1))])]),p.length?(s(),f(I,{key:0,errors:p},null,8,["errors"])):x("",!0)]),_:2},1032,["data-invalid"])]),_:1}),a(e(J),{name:"is_public"},{default:l(({field:p,errors:v,setValue:Y})=>[a(A,{"data-invalid":!!v.length,orientation:"horizontal"},{default:l(()=>[a(T,{for:"is_public",class:"cursor-pointer flex-1"},{default:l(()=>[...t[17]||(t[17]=[m(" Сделать публичным ",-1)])]),_:1}),a(ke,{id:"is_public",checked:!!p.value,"onUpdate:modelValue":Y},null,8,["checked","onUpdate:modelValue"]),v.length?(s(),f(I,{key:0,errors:v},null,8,["errors"])):x("",!0)]),_:2},1032,["data-invalid"])]),_:1})]),_:1}),a(se,null,{default:l(()=>[a(n,{type:"button",variant:"outline",onClick:t[0]||(t[0]=p=>b.value=!1),disabled:e(R)},{default:l(()=>[...t[18]||(t[18]=[m(" Отмена ",-1)])]),_:1},8,["disabled"]),a(xe,{type:"submit",label:"Добавить","is-processing":e(R)},null,8,["is-processing"])]),_:1})]),_:1},8,["validation-schema"])):x("",!0)]),_:1})]),_:1},8,["open"])]),e(Q)?(s(),g("div",va,[a(ie,{class:"aspect-[3/4] w-full rounded-lg"}),a(ie,{class:"aspect-[3/4] w-full rounded-lg"}),a(ie,{class:"aspect-[3/4] w-full rounded-lg"}),a(ie,{class:"aspect-[3/4] w-full rounded-lg"})])):!e(ue)||e(ue).length===0?(s(),g("div",ha,[r("div",ba,[t[21]||(t[21]=r("p",{class:"text-muted-foreground mb-4 text-lg"},"У вас пока нет работ в портфолио",-1)),a(n,{onClick:t[1]||(t[1]=c=>b.value=!0)},{default:l(()=>[a(e(Se),{class:"w-4 h-4"}),t[20]||(t[20]=m(" Добавить первую работу ",-1))]),_:1})])])):(s(),g("div",ya,[(s(!0),g(Z,null,ee(e(ue),c=>(s(),g("div",{key:c.id,onClick:p=>Be(c),class:"cursor-pointer"},[a(Qe,{category:c.category,description:c.description,image_url:c.image_url,is_public:c.is_public,likes_count:c.likes_count,views_count:c.views_count,created_at:c.created_at,updated_at:c.updated_at},null,8,["category","description","image_url","is_public","likes_count","views_count","created_at","updated_at"])],8,ka))),128))])),a(re,{open:e(y),"onUpdate:open":t[5]||(t[5]=c=>{y.value=c,c||(M.value=0)})},{default:l(()=>[a(ne,{class:"sm:max-w-md"},{default:l(()=>[e(u)?(s(),f(w,{key:0},{default:l(()=>[a(d,null,{default:l(()=>[m(q(e(u).category),1)]),_:1}),a(_,null,{default:l(()=>[m(q(e(u).description),1)]),_:1})]),_:1})):x("",!0),e(u)?(s(),g("div",wa,[e(u).image_url&&e(u).image_url.length>0?(s(),g("div",xa,[r("div",Ca,[r("img",{src:e(u).image_url[e(M)],alt:`${e(u).category} - ${e(M)+1}`,class:"h-full w-full object-cover transition-opacity duration-300",loading:"lazy"},null,8,Ua),e(u).image_url.length>1?(s(),f(n,{key:0,onClick:Te,type:"button",class:"absolute left-2 top-1/2 -translate-y-1/2 rounded-full bg-background/80 backdrop-blur-sm p-2 text-foreground shadow-lg transition-all hover:bg-background/90 disabled:opacity-50",disabled:e(u).image_url.length<=1},{default:l(()=>[a(e(Ft),{class:"h-5 w-5"})]),_:1},8,["disabled"])):x("",!0),e(u).image_url.length>1?(s(),f(n,{key:1,onClick:Me,type:"button",class:"absolute right-2 top-1/2 -translate-y-1/2 rounded-full bg-background/80 backdrop-blur-sm p-2 text-foreground shadow-lg transition-all hover:bg-background/90 disabled:opacity-50",disabled:e(u).image_url.length<=1},{default:l(()=>[a(e(Rt),{class:"h-5 w-5"})]),_:1},8,["disabled"])):x("",!0),e(u).image_url.length>1?(s(),g("div",$a,q(e(M)+1)+" / "+q(e(u).image_url.length),1)):x("",!0),e(u).image_url.length>1?(s(),g("div",Sa,[(s(!0),g(Z,null,ee(e(u).image_url,(c,p)=>(s(),f(n,{key:p,onClick:v=>M.value=p,type:"button",class:fe(["h-2 w-2 rounded-full transition-all",p===e(M)?"bg-primary w-6":"bg-background/60 hover:bg-background/80"]),"aria-label":`Перейти к изображению ${p+1}`},null,8,["onClick","class","aria-label"]))),128))])):x("",!0)])])):x("",!0),r("div",Ia,[r("div",Pa,[a(e(qe),{class:"w-4 h-4"}),r("span",null,q(e(u).views_count)+" просмотров",1)]),r("div",Va,[a(e(jt),{class:"w-4 h-4"}),r("span",null,q(e(u).likes_count)+" лайков",1)]),e(u).is_public?(s(),g("div",qa,[a(e(Bt),{class:"w-4 h-4"}),t[22]||(t[22]=r("span",null,"Публичное",-1))])):(s(),g("div",Da,[a(e(zt),{class:"w-4 h-4"}),t[23]||(t[23]=r("span",null,"Приватное",-1))]))]),r("div",ja,[r("p",null,"Создано: "+q(me(e(u).created_at)),1),e(u).updated_at!==e(u).created_at?(s(),g("p",Ba," Обновлено: "+q(me(e(u).updated_at)),1)):x("",!0)])])):x("",!0),a(se,null,{default:l(()=>[a(n,{variant:"outline",onClick:t[2]||(t[2]=c=>y.value=!1)},{default:l(()=>[...t[24]||(t[24]=[m(" Закрыть ",-1)])]),_:1}),e(u)?.is_public?(s(),f(n,{key:0,variant:"outline",onClick:Fe,size:"icon"},{default:l(()=>[...t[25]||(t[25]=[r("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[r("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.368 2.684 3 3 0 00-5.368-2.684z"})],-1)])]),_:1})):x("",!0),a(n,{variant:"destructive",onClick:t[3]||(t[3]=c=>Ge(e(u))),size:"icon"},{default:l(()=>[a(e(Ie),{class:"w-4 h-4"})]),_:1}),a(n,{onClick:t[4]||(t[4]=c=>Oe(e(u)))},{default:l(()=>[a(e(Et),{class:"w-4 h-4 mr-2"}),t[26]||(t[26]=m(" Редактировать ",-1))]),_:1})]),_:1})]),_:1})]),_:1},8,["open"]),a(re,{open:e(S),"onUpdate:open":Ne},{default:l(()=>[a(ne,{class:"sm:max-w-2xl"},{default:l(()=>[a(w,null,{default:l(()=>[a(d,null,{default:l(()=>[...t[27]||(t[27]=[m("Редактировать портфолио",-1)])]),_:1}),a(_,null,{default:l(()=>[...t[28]||(t[28]=[m(" Измените информацию о вашей работе ",-1)])]),_:1})]),_:1}),e(S)&&e(j)?(s(),f(e(Ce),{key:`edit-${e(j).id}`,"validation-schema":e(Ue)("portfolioCreateSchema"in o?o.portfolioCreateSchema:e($e)),"initial-values":e(De),onSubmit:Je},{default:l(()=>[a(we,{class:"py-4"},{default:l(()=>[a(F,{name:"category",label:"Категория",placeholder:"Выберите категорию",options:h,"errors-to-show":"all"}),a(e(J),{name:"description"},{default:l(({field:c,errors:p,setValue:v})=>[a(A,{"data-invalid":!!p.length},{default:l(()=>[a(T,{for:"description"},{default:l(()=>[...t[29]||(t[29]=[m(" Описание ",-1)])]),_:1}),a(G,{id:"description",placeholder:"Опишите вашу работу","aria-invalid":!!p.length,modelValue:c.value,"onUpdate:modelValue":v},null,8,["aria-invalid","modelValue","onUpdate:modelValue"]),p.length?(s(),f(I,{key:0,errors:p},null,8,["errors"])):x("",!0)]),_:2},1032,["data-invalid"])]),_:1}),a(e(J),{name:"image_file"},{default:l(({errors:c})=>[a(A,{"data-invalid":!!c.length},{default:l(()=>[a(T,null,{default:l(()=>[...t[30]||(t[30]=[m(" Изображения ",-1)])]),_:1}),r("div",Ma,[e(E).length>0?(s(),g("div",Ta,[(s(!0),g(Z,null,ee(e(E),(p,v)=>(s(),g("div",{key:v,class:"relative aspect-square w-full overflow-hidden rounded-lg bg-muted"},[r("img",{src:p,alt:`Изображение ${v+1}`,class:"h-full w-full object-cover"},null,8,Fa),r("button",{type:"button",onClick:()=>He(v),class:"absolute right-1 top-1 rounded-full bg-destructive p-1 text-destructive-foreground hover:bg-destructive/90"},[...t[31]||(t[31]=[r("svg",{class:"h-3 w-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[r("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])],8,Ra)]))),128))])):x("",!0),e(B).length>0?(s(),g("div",za,[(s(!0),g(Z,null,ee(e(B),(p,v)=>(s(),g("div",{key:v,class:"relative aspect-square w-full overflow-hidden rounded-lg bg-muted"},[r("img",{src:p.url,alt:`Превью ${v+1}`,class:"h-full w-full object-cover"},null,8,Ea),r("button",{type:"button",onClick:()=>be(v),class:"absolute right-1 top-1 rounded-full bg-destructive p-1 text-destructive-foreground hover:bg-destructive/90"},[...t[32]||(t[32]=[r("svg",{class:"h-3 w-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[r("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])],8,La)]))),128))])):x("",!0),r("div",null,[r("input",{ref_key:"editImageInput",ref:oe,type:"file",accept:"image/*",multiple:"",class:"hidden",onChange:Ke},null,544),a(n,{type:"button",variant:"outline",disabled:e(k),onClick:t[6]||(t[6]=p=>e(oe)?.click()),class:"w-full"},{default:l(()=>[e(k)?(s(),f(X,{key:1,size:"sm",class:"mr-2"})):(s(),f(e(Pe),{key:0,class:"mr-2 h-4 w-4"})),m(" "+q(e(k)?"Загрузка...":e(P).length>0?`Добавить ещё (${e(P).length} выбрано)`:"Добавить изображения"),1)]),_:1},8,["disabled"]),t[33]||(t[33]=r("p",{class:"mt-1 text-xs text-muted-foreground"}," Поддерживаемые форматы: JPG, PNG, GIF. Максимальный размер файла: 10МБ ",-1))])]),c.length?(s(),f(I,{key:0,errors:c},null,8,["errors"])):x("",!0)]),_:2},1032,["data-invalid"])]),_:1}),a(e(J),{name:"is_public"},{default:l(({field:c,errors:p,setValue:v})=>[a(A,{"data-invalid":!!p.length,orientation:"horizontal"},{default:l(()=>[a(T,{for:"is_public",class:"cursor-pointer flex-1"},{default:l(()=>[...t[34]||(t[34]=[m(" Сделать публичным ",-1)])]),_:1}),a(ke,{id:"is_public","model-value":c.value,"onUpdate:modelValue":v,"aria-invalid":!!p.length},null,8,["model-value","onUpdate:modelValue","aria-invalid"]),p.length?(s(),f(I,{key:0,errors:p},null,8,["errors"])):x("",!0)]),_:2},1032,["data-invalid"])]),_:1})]),_:1}),a(se,null,{default:l(()=>[a(n,{type:"button",variant:"outline",onClick:t[7]||(t[7]=c=>S.value=!1),disabled:e(z)},{default:l(()=>[...t[35]||(t[35]=[m(" Отмена ",-1)])]),_:1},8,["disabled"]),a(xe,{type:"submit",label:"Сохранить","is-processing":e(z)},null,8,["is-processing"])]),_:1})]),_:1},8,["validation-schema","initial-values"])):x("",!0)]),_:1})]),_:1},8,["open"]),a(re,{open:e(W),"onUpdate:open":t[9]||(t[9]=c=>W.value=c)},{default:l(()=>[a(ne,{class:"sm:max-w-md"},{default:l(()=>[a(w,null,{default:l(()=>[a(d,{class:"flex items-center gap-2"},{default:l(()=>[a(e(vt),{class:"h-5 w-5 text-destructive"}),t[36]||(t[36]=m(" Удалить портфолио ",-1))]),_:1}),a(_,null,{default:l(()=>[...t[37]||(t[37]=[m(" Вы уверены, что хотите удалить это портфолио? Это действие нельзя отменить. Все изображения также будут удалены. ",-1)])]),_:1})]),_:1}),a(se,null,{default:l(()=>[a(n,{variant:"outline",onClick:t[8]||(t[8]=c=>W.value=!1),disabled:e(L)},{default:l(()=>[...t[38]||(t[38]=[m(" Отмена ",-1)])]),_:1},8,["disabled"]),a(n,{variant:"destructive",onClick:Ae,disabled:e(L)},{default:l(()=>[e(L)?(s(),f(X,{key:1,size:"sm",class:"mr-2"})):(s(),f(e(Ie),{key:0,class:"w-4 h-4 mr-2"})),m(" "+q(e(L)?"Удаление...":"Удалить"),1)]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["open"])])}}});export{sl as default};
